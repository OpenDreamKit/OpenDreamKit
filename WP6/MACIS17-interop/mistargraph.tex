\documentclass{standalone}
\usepackage{tikz}
\usetikzlibrary{backgrounds,shadows,shapes,fit,arrows}
\usetikzlibrary{decorations.pathmorphing}
\begin{document}
\providecommand\myxscale{1.5}
\providecommand\myyscale{1.5}
\providecommand\mysize{\normalsize}
    \begin{tikzpicture}[xscale=\myxscale,yscale=\myyscale]\mysize
      \tikzstyle{withshadow}=[draw,drop shadow={opacity=.5},fill=white]
      \tikzstyle{system}=[draw,withshadow]
      \tikzstyle{standard}=[circle,fill=blue!30,inner sep = 1pt]
      \tikzstyle{interface}=[circle,fill=purple!30,inner sep = 1pt]
      \tikzstyle{align}=[dotted,thick]
      \tikzstyle{gen}=[dashed,-angle 45]
      \node[system] (a) at (0,.3) {$A$};
      \node[system] (b) at (1,.3) {$B$};
      \node[system] (c) at (1.7,1) {$C$};
      \node[system] (d) at (1.7,2) {$D$};
      \node[system] (e) at (1,2.7) {$E$};
      \node[system] (f) at (0,2.7) {$F$};
      \node[system] (g) at (-.7,2) {$G$};
      \node[system] (h) at (-.7,1) {$H$};
      \node[standard] (m) at (.5,1.5) {\small MitM};
      \node[interface] (ia) at (0.2,.9) {a};
      \node[interface] (ib) at (.8,.9) {b};
      \node[interface] (ic) at (1.1,1.2) {c};
      \node[interface] (id) at (1.1,1.75) {d};
      \node[interface] (ie) at (.8,2.1) {e};
      \node[interface] (if) at (0.2,2.1) {f};
      \node[interface] (ig) at (-.1,1.75) {g};
      \node[interface] (ih) at (-.1,1.2) {h};
      \draw[align] (m) -- (ia);
      \draw[align] (m) -- (ib);
      \draw[align] (m) -- (ic);
      \draw[align] (m) -- (id);
      \draw[align] (m) -- (ie);
      \draw[align] (m) -- (if);
      \draw[align] (m) -- (ig);
      \draw[align] (m) -- (ih);
      \draw[gen] (a) -- (ia);
      \draw[gen] (b) -- (ib);
      \draw[gen] (c) -- (ic);
      \draw[gen] (d) -- (id);
      \draw[gen] (e) -- (ie);
      \draw[gen] (f) -- (if);
      \draw[gen] (g) -- (ig);
      \draw[gen] (h) -- (ih);
      \begin{pgfonlayer}{background}
        \node[draw,cloud,fit=(ia) (ib) (ic) (id) (ie) (if) (ig) (ih),
                   inner sep=-7pt,withshadow] (st) {};
        \node[fit=(d) (id),ellipse,inner sep=-1pt,rotate=20,draw,dashed,red] (sys) {};
      \end{pgfonlayer}
      \end{tikzpicture}
\end{document}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "paper"
%%% End:
